<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reference points • salmonMSE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reference points">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">salmonMSE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Simple example</a></li>
    <li><a class="dropdown-item" href="../articles/decision-table.html">Decision table</a></li>
    <li><a class="dropdown-item" href="../articles/example-multi.html">Multi-population model</a></li>
    <li><a class="dropdown-item" href="../articles/equations.html">Dynamics equations</a></li>
    <li><a class="dropdown-item" href="../articles/ref.html">Reference points</a></li>
    <li><a class="dropdown-item" href="../articles/conditioning.html">Conditioning model</a></li>
    <li><a class="dropdown-item" href="../articles/model.html">Implementation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Blue-Matter/salmonMSE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reference points</h1>
            
            <h4 data-toc-skip class="date">2025-07-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/salmonMSE/blob/master/vignettes/ref.Rmd" class="external-link"><code>vignettes/ref.Rmd</code></a></small>
      <div class="d-none name"><code>ref.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Reference points for salmon typically use the Ricker stock function
that predict the return from the number of spawners.</p>
<p>The Ricker function is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mi>a</mi><mo>×</mo><mi>S</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>b</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
R = a\times S\exp(-bS)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is the return and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is the spawners. Parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is in units of returns/spawner and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is in units of reciprocal spawners.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><annotation encoding="application/x-tex">S_\textrm{MSY}</annotation></semantics></math>
be the spawner abundance that maximizes catch
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>−</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">R-S</annotation></semantics></math>,
which can be obtained by maximizing the function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>−</mo><mi>S</mi><mo>=</mo><mi>a</mi><mo>×</mo><mi>S</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>b</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">
R - S = a\times S\exp(-b S) - S
</annotation></semantics></math></p>
<p>The implicit solution, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha = \log(a)</annotation></semantics></math>,
satisfies</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>b</mi><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>−</mo><mi>b</mi><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
(1 - bS_\textrm{MSY})\exp(\alpha - bS_\textrm{MSY}) = 1
</annotation></semantics></math></p>
<p>and can be solved numerically (<a href="https://doi.org/10.7717/peerj.1623" class="external-link">Scheuerell 2016</a>).</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><annotation encoding="application/x-tex">S_\textrm{MSY}</annotation></semantics></math>
is also the spawner abundance that maximizes excess returns above the
one-to-one line.</p>
<p>The harvest rate corresponding to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><annotation encoding="application/x-tex">S_\textrm{MSY}</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mtext mathvariant="normal">MSY</mtext></msub><mo>=</mo><mi>b</mi><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub></mrow><annotation encoding="application/x-tex">
U_\textrm{MSY} = bS_\textrm{MSY}
</annotation></semantics></math></p>
<p>The quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mtext mathvariant="normal">gen</mtext></msub><annotation encoding="application/x-tex">S_\textrm{gen}</annotation></semantics></math>
is the spawner abundance that would reach the spawner abundance at MSY
after one generation without fishing (<a href="https://www.dfo-mpo.gc.ca/csas-sccs/Publications/ResDocs-DocRech/2009/2009_058-eng.htm" class="external-link">Holt
et al. 2009</a>), and satisfies the equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><mo>=</mo><mi>a</mi><mo>×</mo><msub><mi>S</mi><mtext mathvariant="normal">gen</mtext></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>b</mi><mo>×</mo><msub><mi>S</mi><mtext mathvariant="normal">gen</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
S_\textrm{MSY}=a\times S_\textrm{gen}\exp(-b\times S_\textrm{gen})
</annotation></semantics></math></p>
<p>There are several implicit assumptions associated with these
reference points:</p>
<ol style="list-style-type: decimal">
<li>The stock-recruit relationship predicts the number of returns, not
juveniles</li>
<li>All returns are the same age</li>
<li>All exploitation occurs on mature individuals</li>
<li>All returns are equally vulnerable to the fishery</li>
<li>All spawners are equally fecund</li>
</ol>
</div>
<div class="section level2">
<h2 id="reference-points-in-salmonmse">Reference points in salmonMSE<a class="anchor" aria-label="anchor" href="#reference-points-in-salmonmse"></a>
</h2>
<p>salmonMSE is an age-structured model that can relax the assumptions
from the introduction:</p>
<ol style="list-style-type: decimal">
<li>The stock-recruit relationship predicts the number of outmigrating
juveniles, not the return, from the egg production</li>
<li>The calendar-year return can comprise of multiple brood years</li>
<li>Exploitation can occur on both immature and mature individuals</li>
<li>Fish vulnerability can vary by age</li>
<li>Older, larger spawners can be more fecund than younger fish</li>
</ol>
<p>Reference points are calculated with more structural complexity
compared to the simple approach. However, comparisons below indicate the
many situations where the salmonMSE reference points overlap with the
typical salmon approach.</p>
<div class="section level3">
<h3 id="calculations-for-msy">Calculations for MSY<a class="anchor" aria-label="anchor" href="#calculations-for-msy"></a>
</h3>
<p>Given exploitation in both the immature and mature component of the
population, the juvenile survival of an outmigrating individual
(“smolt”) to age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>ℓ</mo><mi>a</mi></msub><mo>=</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>M</mi><mi>j</mi></msub><mo>+</mo><msubsup><mi>v</mi><mi>j</mi><mtext mathvariant="normal">PT</mtext></msubsup><msup><mi>F</mi><mtext mathvariant="normal">PT</mtext></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\ell_a = \prod_{j=1}^{a-1}\exp(-[M_j+v^\textrm{PT}_jF^\textrm{PT}])(1 - p_j)
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
is natural mortality,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>v</mi><mtext mathvariant="normal">PT</mtext></msup><annotation encoding="application/x-tex">v^\textrm{PT}</annotation></semantics></math>
is vulnerability at age in the preterminal fishery,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>F</mi><mtext mathvariant="normal">PT</mtext></msup><annotation encoding="application/x-tex">F^\textrm{PT}</annotation></semantics></math>
is fishing mortality in the preterminal fishery, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is maturity.</p>
<p>The corresponding return per juvenile
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>a</mi></msub><mo>=</mo><msub><mo>ℓ</mo><mi>a</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msubsup><mi>v</mi><mi>a</mi><mtext mathvariant="normal">PT</mtext></msubsup><msup><mi>F</mi><mtext mathvariant="normal">PT</mtext></msup><mo stretchy="false" form="postfix">]</mo><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r_a = \ell_a \exp(-v^\textrm{PT}_aF^\textrm{PT}])(1 - p_a)</annotation></semantics></math>.</p>
<p>The corresponding escapement per juvenile is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>a</mi></msub><mo>=</mo><msub><mi>r</mi><mi>a</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msubsup><mi>v</mi><mi>a</mi><mtext mathvariant="normal">T</mtext></msubsup><msup><mi>F</mi><mtext mathvariant="normal">T</mtext></msup><mo stretchy="false" form="postfix">]</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s_a = r_a \exp(-v^\textrm{T}_aF^\textrm{T}])</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>v</mi><mtext mathvariant="normal">T</mtext></msup><annotation encoding="application/x-tex">v^\textrm{T}</annotation></semantics></math>
is vulnerability at age in the fishery and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>F</mi><mtext mathvariant="normal">T</mtext></msup><annotation encoding="application/x-tex">F^\textrm{T}</annotation></semantics></math>
is fishing mortality in the terminal fishery.</p>
<p>The corresponding egg production per juvenile
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><msub><mo>∑</mo><mi>a</mi></msub><msub><mi>s</mi><mi>a</mi></msub><msub><mi>f</mi><mi>a</mi></msub><msup><mi>p</mi><mtext mathvariant="normal">female</mtext></msup></mrow><annotation encoding="application/x-tex">\phi = \sum_a s_a f_a p^\textrm{female}</annotation></semantics></math>.</p>
<p>The equilibrium juvenile production
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is calculated from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
as:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>′</mi><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mi>′</mi><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">J = \log(a'\phi)/(b'\phi)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">a'</annotation></semantics></math>
is in units of juvenile per egg and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">b'</annotation></semantics></math>
is in units of per egg.</p>
<p>The total return is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>a</mi></msub><mi>J</mi><mo>×</mo><msub><mi>r</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">\sum_a J \times r_a</annotation></semantics></math>
and total spawners is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>a</mi></msub><mi>J</mi><mo>×</mo><msub><mi>s</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">\sum_a J \times s_a</annotation></semantics></math>.</p>
<p>The maximum sustainable yield state variables are values obtained
from maximizing the total catch:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>J</mi><mo>×</mo><msub><mo>ℓ</mo><mi>a</mi></msub><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>v</mi><mi>a</mi><mtext mathvariant="normal">PT</mtext></msubsup><msup><mi>F</mi><mtext mathvariant="normal">PT</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>J</mi><mo>×</mo><msub><mi>r</mi><mi>a</mi></msub><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>v</mi><mi>a</mi><mtext mathvariant="normal">T</mtext></msubsup><msup><mi>F</mi><mtext mathvariant="normal">T</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
C = \sum_a J\times\ell_a\times(1 - \exp(v^\textrm{PT}_aF^\textrm{PT})) + \sum_a J\times r_a\times(1 - \exp(v^\textrm{T}_aF^\textrm{T}))
</annotation></semantics></math></p>
<p>The optimization calculates the corresponding fishery effort
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mtext mathvariant="normal">MSY</mtext></msub><annotation encoding="application/x-tex">E_\textrm{MSY}</annotation></semantics></math>.
The user needs to specify the relative effort to the preterminal and
terminal fisheries
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mn>1</mn></msub><annotation encoding="application/x-tex">e_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mn>2</mn></msub><annotation encoding="application/x-tex">e_2</annotation></semantics></math>),
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mtext mathvariant="normal">PT,MSY</mtext></msup><mo>=</mo><msub><mi>e</mi><mn>1</mn></msub><mo>×</mo><msub><mi>E</mi><mtext mathvariant="normal">MSY</mtext></msub></mrow><annotation encoding="application/x-tex">F^\textrm{PT,MSY} = e_1 \times E_\textrm{MSY}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mtext mathvariant="normal">T,MSY</mtext></msup><mo>=</mo><msub><mi>e</mi><mn>2</mn></msub><mo>×</mo><msub><mi>E</mi><mtext mathvariant="normal">MSY</mtext></msub></mrow><annotation encoding="application/x-tex">F^\textrm{T,MSY} = e_2 \times E_\textrm{MSY}</annotation></semantics></math>.</p>
<p>An alternative optimization scheme maximizes excess recruitment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>−</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">R - S</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>−</mo><mi>S</mi><mo>=</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>J</mi><mo>×</mo><msub><mi>r</mi><mi>a</mi></msub><mo>−</mo><munder><mo>∑</mo><mi>a</mi></munder><mi>J</mi><mo>×</mo><msub><mi>s</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">
R - S = \sum_a J \times r_a - \sum_a J \times s_a
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="calculations-for-sgen">Calculations for Sgen<a class="anchor" aria-label="anchor" href="#calculations-for-sgen"></a>
</h3>
<p>Sgen is calculated by a subsequent optimization algorithm to search
for the fishery effort
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mtext mathvariant="normal">gen</mtext></msub><annotation encoding="application/x-tex">E_\textrm{gen}</annotation></semantics></math>
that generates an equilibrium distributions at age, then projects the
population for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mtext mathvariant="normal">gen</mtext></msub><annotation encoding="application/x-tex">n_\textrm{gen}</annotation></semantics></math>
years with no fishing, such that the spawning abundance is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><annotation encoding="application/x-tex">S_\textrm{MSY}</annotation></semantics></math>
at the end of the projection.</p>
<p>If there is partial maturity at several age classes, the number of
years for the projection is unclear. The population can recover to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mtext mathvariant="normal">MSY</mtext></msub><annotation encoding="application/x-tex">S_\textrm{MSY}</annotation></semantics></math>
with either increased survival, increased juvenile production, or both.
Currently, salmonMSE will use the first age of maturity, e.g., typically
two years for Chinook salmon, for the projection duration. Comparisons
in the next section indicate that Sgen between the two methods
frequently agree using this projection duration.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-between-methods">Comparison between methods<a class="anchor" aria-label="anchor" href="#comparison-between-methods"></a>
</h2>
<p>Currently, salmonMSE parameterizes the operating model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
(returns/spawner),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
(juveniles/egg) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mn>1</mn><mi>/</mi><mi>b</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">Smax = 1/b'</annotation></semantics></math>
(eggs).</p>
<p>The following function facilitates comparison of the salmonMSE and
Ricker SRR reference points in the various examples. Some conversion is
also needed to convert between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">b'</annotation></semantics></math>
(1/eggs) to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
(1/spawners).</p>
<p>In summary, if the age-structured reference point calculation only
includes terminal exploitation, then the reference points are equivalent
with values from the Ricker model unless both fecundity and
vulnerability vary with age.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare_ref</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span> <span class="op">=</span> <span class="fl">3</span>, <span class="co"># Units of recruits/spawner</span></span>
<span>                        <span class="va">b</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>, <span class="co"># Units of reciprocal spawners</span></span>
<span>                        <span class="va">maxage</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                        <span class="va">rel_F</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># e_1 and e_2</span></span>
<span>                        <span class="va">p_female</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        <span class="va">vulPT</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">maxage</span><span class="op">)</span>,</span>
<span>                        <span class="va">vulT</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        <span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                        <span class="va">fec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1500</span>, <span class="fl">3000</span>, <span class="fl">3200</span>, <span class="fl">3500</span><span class="op">)</span>,</span>
<span>                        <span class="va">p_mature</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://docs.salmonmse.com/">salmonMSE</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Calculate eggs per smolt</span></span>
<span>  <span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu">salmonMSE</span><span class="fu">:::</span><span class="fu"><a href="../reference/calc_phi.html">calc_phi</a></span><span class="op">(</span></span>
<span>    Mjuv <span class="op">=</span> <span class="va">M</span>,</span>
<span>    p_mature <span class="op">=</span> <span class="va">p_mature</span>,</span>
<span>    p_female <span class="op">=</span> <span class="va">p_female</span>,</span>
<span>    fec <span class="op">=</span> <span class="va">fec</span>,</span>
<span>    s_enroute <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># To convert Smax from units of spawners to eggs:</span></span>
<span>  <span class="co"># 1. Calculate unfished spawners from Ricker SRR, set R = S --&gt; S0 = log(a)/b</span></span>
<span>  <span class="co"># 2. Calculate spawners per juvenile (spro)</span></span>
<span>  <span class="co"># 3. Calculate smolt per egg (phi)</span></span>
<span>  <span class="co"># 4. unfished eggs (eo) = unfished spawners * juvenile per spawner * egg per smolt</span></span>
<span>  <span class="co"># 5. Smax_eggs = log(a) / unfished eggs</span></span>
<span>  <span class="va">spro</span> <span class="op">&lt;-</span> <span class="fu">salmonMSE</span><span class="fu">:::</span><span class="fu"><a href="../reference/calc_phi.html">calc_phi</a></span><span class="op">(</span></span>
<span>    Mjuv <span class="op">=</span> <span class="va">M</span>,</span>
<span>    p_mature <span class="op">=</span> <span class="va">p_mature</span>,</span>
<span>    p_female <span class="op">=</span> <span class="va">p_female</span>,</span>
<span>    fec <span class="op">=</span> <span class="va">fec</span>,</span>
<span>    s_enroute <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"spawner"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Smax</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span></span>
<span>  <span class="va">so</span> <span class="op">&lt;-</span> <span class="va">Smax</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>  <span class="va">eo</span> <span class="op">&lt;-</span> <span class="va">so</span> <span class="op">/</span> <span class="va">spro</span> <span class="op">*</span> <span class="va">phi</span></span>
<span>  <span class="va">beta_eggs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">/</span><span class="va">eo</span></span>
<span>  <span class="va">Smax_eggs</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">beta_eggs</span></span>
<span></span>
<span>  <span class="va">SRRpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    kappa <span class="op">=</span> <span class="va">a</span>,</span>
<span>    Smax <span class="op">=</span> <span class="va">Smax_eggs</span>,</span>
<span>    phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>    SRrel <span class="op">=</span> <span class="st">"Ricker"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># salmonMSE ref</span></span>
<span>  <span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_ref.html">calc_MSY</a></span><span class="op">(</span></span>
<span>    <span class="va">M</span>, <span class="va">fec</span>, <span class="va">p_female</span>, <span class="va">rel_F</span>, <span class="va">vulPT</span>, <span class="va">vulT</span>, <span class="va">p_mature</span>,</span>
<span>    s_enroute <span class="op">=</span> <span class="fl">1</span>, SRRpars <span class="op">=</span> <span class="va">SRRpars</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">ref</span><span class="op">[</span><span class="st">"Sgen"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_ref.html">calc_Sgen</a></span><span class="op">(</span></span>
<span>    <span class="va">M</span>, <span class="va">fec</span>, <span class="va">p_female</span>, <span class="va">rel_F</span>, <span class="va">vulPT</span>, <span class="va">vulT</span>, <span class="va">p_mature</span>,</span>
<span>    s_enroute <span class="op">=</span> <span class="fl">1</span>, SRRpars <span class="op">=</span> <span class="va">SRRpars</span>, SMSY <span class="op">=</span> <span class="va">ref</span><span class="op">[</span><span class="st">"Spawners_MSY"</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">ref</span><span class="op">[</span><span class="st">"Catch/Return"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ref</span><span class="op">[</span><span class="st">"KT_MSY"</span><span class="op">]</span><span class="op">/</span><span class="va">ref</span><span class="op">[</span><span class="st">"Return_MSY"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">ref_salmonMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span></span>
<span>    <span class="va">ref</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UPT_MSY"</span>, <span class="st">"UT_MSY"</span>, <span class="st">"Catch/Return"</span>, <span class="st">"Spawners_MSY"</span>, <span class="st">"Sgen"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UMSY (preterminal)"</span>, <span class="st">"UMSY (terminal)"</span>, <span class="st">"Terminal Catch/Return"</span>, <span class="st">"SMSY"</span>, <span class="st">"Sgen"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Ricker SRR calcs</span></span>
<span>  <span class="va">ref_Ricker</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">umsy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_Smsy_Ricker.html">calc_Umsy_Ricker</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">smsy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_Smsy_Ricker.html">calc_Smsy_Ricker</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="va">b</span><span class="op">)</span></span>
<span>    <span class="va">sgen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_Smsy_Ricker.html">calc_Sgen_Ricker</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="va">b</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">umsy</span>, <span class="va">smsy</span>, <span class="va">sgen</span><span class="op">)</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UMSY"</span>, <span class="st">"SMSY"</span>, <span class="st">"Sgen"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    salmonMSE <span class="op">=</span> <span class="va">ref_salmonMSE</span>,</span>
<span>    Ricker <span class="op">=</span> <span class="va">ref_Ricker</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="situation-1---single-age-of-maturity">Situation 1 - single age of maturity<a class="anchor" aria-label="anchor" href="#situation-1---single-age-of-maturity"></a>
</h3>
<p>Situation 1 specifies the salmonMSE (age-structured) model with the
simple assumptions identified in the introduction. The salmonMSE and
Ricker (stock-recruit only) reference points are identical.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">compare_ref</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  maxage <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  rel_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  p_female <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  vulPT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  vulT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># SAR = 0.01</span></span>
<span>  fec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  p_mature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: salmonMSE</span></span>
<span><span class="co">#&gt; $salmonMSE</span></span>
<span><span class="co">#&gt;    UMSY (preterminal)       UMSY (terminal) Terminal Catch/Return </span></span>
<span><span class="co">#&gt;             0.0000000             0.4678228             0.4678228 </span></span>
<span><span class="co">#&gt;                  SMSY                  Sgen </span></span>
<span><span class="co">#&gt;           467.8334508           188.2447444 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Ricker</span></span>
<span><span class="co">#&gt;        UMSY        SMSY        Sgen </span></span>
<span><span class="co">#&gt;   0.4678265 467.8265256 188.2417444</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="situation-2---partial-age-maturity-equal-vulnerability">Situation 2 - partial age maturity, equal vulnerability<a class="anchor" aria-label="anchor" href="#situation-2---partial-age-maturity-equal-vulnerability"></a>
</h3>
<p>Situation 2 specifies the salmonMSE (age-structured) model with
age-specific juvenile mortality and maturity. All spawners are identical
with fecundity = 1 and fully vulnerable to the fishery.</p>
<p>The salmonMSE and Ricker-only reference points are identical.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">compare_ref</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  maxage <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  rel_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  p_female <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  vulPT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  vulT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  fec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  p_mature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $salmonMSE</span></span>
<span><span class="co">#&gt;    UMSY (preterminal)       UMSY (terminal) Terminal Catch/Return </span></span>
<span><span class="co">#&gt;             0.0000000             0.4678228             0.4678228 </span></span>
<span><span class="co">#&gt;                  SMSY                  Sgen </span></span>
<span><span class="co">#&gt;           467.8334508           188.2447444 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Ricker</span></span>
<span><span class="co">#&gt;        UMSY        SMSY        Sgen </span></span>
<span><span class="co">#&gt;   0.4678265 467.8265256 188.2417444</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="situation-3---partial-age-maturity-varying-vulnerability-by-age">Situation 3 - partial age maturity, varying vulnerability by
age<a class="anchor" aria-label="anchor" href="#situation-3---partial-age-maturity-varying-vulnerability-by-age"></a>
</h3>
<p>Situation 3 is the same as 2 except with age-varying fishery
vulnerability.</p>
<p>The salmonMSE and Ricker-only reference points are identical.</p>
<p>One nuance is how to report the exploitation rate, since it varies by
age due to differential vulnerability. UMSY reported in salmonMSE is the
maximum value experienced by an age class (typically the oldest), but
the ratio of total catch to total return may be more appropriate
metric.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">compare_ref</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  maxage <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  rel_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  p_female <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  vulPT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  vulT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  fec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  p_mature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $salmonMSE</span></span>
<span><span class="co">#&gt;    UMSY (preterminal)       UMSY (terminal) Terminal Catch/Return </span></span>
<span><span class="co">#&gt;             0.0000000             0.7330604             0.4678273 </span></span>
<span><span class="co">#&gt;                  SMSY                  Sgen </span></span>
<span><span class="co">#&gt;           467.8250871           188.2409734 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Ricker</span></span>
<span><span class="co">#&gt;        UMSY        SMSY        Sgen </span></span>
<span><span class="co">#&gt;   0.4678265 467.8265256 188.2417444</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="situation-4---partial-age-maturity-varying-fecundity-and-vulnerability-by-age">Situation 4 - partial age maturity, varying fecundity and
vulnerability by age<a class="anchor" aria-label="anchor" href="#situation-4---partial-age-maturity-varying-fecundity-and-vulnerability-by-age"></a>
</h3>
<p>Situation 4 is the same as 3 except with age-varying fecundity.</p>
<p>The salmonMSE and Ricker-only reference points are
<strong>not</strong> identical.</p>
<p>Preferential vulnerability by the fishery for return which are not
identical in fecundity are additional complexities not implemented in
Ricker-only reference points.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">compare_ref</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  maxage <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  rel_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  p_female <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  vulPT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  vulT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  fec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, <span class="fl">2000</span>, <span class="fl">3000</span>, <span class="fl">3500</span><span class="op">)</span>,</span>
<span>  p_mature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $salmonMSE</span></span>
<span><span class="co">#&gt;    UMSY (preterminal)       UMSY (terminal) Terminal Catch/Return </span></span>
<span><span class="co">#&gt;             0.0000000             0.6424027             0.4000761 </span></span>
<span><span class="co">#&gt;                  SMSY                  Sgen </span></span>
<span><span class="co">#&gt;           523.7657546           260.2641560 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Ricker</span></span>
<span><span class="co">#&gt;        UMSY        SMSY        Sgen </span></span>
<span><span class="co">#&gt;   0.4678265 467.8265256 188.2417444</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="situation-5---partial-age-maturity-with-immature-exploitation">Situation 5 - partial age maturity, with immature exploitation<a class="anchor" aria-label="anchor" href="#situation-5---partial-age-maturity-with-immature-exploitation"></a>
</h3>
<p>Reference points can also be calculated by considering preterminal
exploitation, e.g., <a href="https://doi.org/10.1139/f86-219" class="external-link">Hankin and
Healey 1986</a>, although this is not common practice.</p>
<p>Preterminal mortality is not explicitly modeled in Ricker-only
reference points.</p>
<p>Thus, salmonMSE and Ricker-only reference points are
<strong>not</strong> identical.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">compare_ref</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>,</span>
<span>  maxage <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  rel_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  p_female <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  vulPT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  vulT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  fec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, <span class="fl">2000</span>, <span class="fl">3000</span>, <span class="fl">3500</span><span class="op">)</span>,</span>
<span>  p_mature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $salmonMSE</span></span>
<span><span class="co">#&gt;    UMSY (preterminal)       UMSY (terminal) Terminal Catch/Return </span></span>
<span><span class="co">#&gt;             0.4670406             0.4670406             0.2553111 </span></span>
<span><span class="co">#&gt;                  SMSY                  Sgen </span></span>
<span><span class="co">#&gt;           535.7260998           315.6413128 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Ricker</span></span>
<span><span class="co">#&gt;        UMSY        SMSY        Sgen </span></span>
<span><span class="co">#&gt;   0.4678265 467.8265256 188.2417444</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quang Huynh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
