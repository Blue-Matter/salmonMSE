<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Implementation of salmon dynamics • salmonMSE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Implementation of salmon dynamics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">salmonMSE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">Simple example</a></li>
    <li><a class="dropdown-item" href="../articles/decision-table.html">Decision table</a></li>
    <li><a class="dropdown-item" href="../articles/example-multi.html">Multi-population model</a></li>
    <li><a class="dropdown-item" href="../articles/equations.html">Dynamics equations</a></li>
    <li><a class="dropdown-item" href="../articles/ref.html">Reference points</a></li>
    <li><a class="dropdown-item" href="../articles/conditioning.html">Conditioning model</a></li>
    <li><a class="dropdown-item" href="../articles/model.html">Implementation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Blue-Matter/salmonMSE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Implementation of salmon dynamics</h1>
            
            <h4 data-toc-skip class="date">2025-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/salmonMSE/blob/master/vignettes/model.Rmd" class="external-link"><code>vignettes/model.Rmd</code></a></small>
      <div class="d-none name"><code>model.Rmd</code></div>
    </div>

    
    
<p>This article documents the implementation of a semelparous salmon
operating model in openMSE and is intended for readers familiar with the
internal structure of the MSEtool package, e.g., developers and advanced
users.</p>
<div class="section level2">
<h2 id="multimse">multiMSE<a class="anchor" aria-label="anchor" href="#multimse"></a>
</h2>
<p>salmonMSE takes advantage of the functionality of the <a href="https://openmse.com/features-multimse/" class="external-link">multiMSE</a> function in
MSEtool. <code>multiMSE</code> is intended for multi-population,
multi-fleet operationg models (class <code>MOM</code>) where the
“population” unit can be envisioned to be any combination of a
sex-specific single species model, multi-species model, or multi-stock
model. Relevant features include:</p>
<ol style="list-style-type: decimal">
<li><p>Two-sex models where the spawning output to predict recruitment
for a population is a linear combination of the spawning output from the
set of populations in the model (using
<code>MOM@SexPars$SSBfrom</code>)</p></li>
<li><p>Hermaphroditism in the sex dynamics such that either females or
males switch sexes. Mechanistically, the abundance moves from one
population to another at the beginning of the time step based on a
specified age schedule (using <code>MOM@SexPars$Herm</code>)</p></li>
<li><p>Inter-population and intra-population dynamics where the
biological parameter for one population is updated by the abundance or
biomass of a set through a custom written function (“MICE” modeling
using <code>MOM@Rel</code>)</p></li>
<li><p>Multi-fleet model that can be used to allocate catches among
populations and fleets</p></li>
</ol>
<p>Salmon dynamics can be represented mechanistically using the above
functionalities:</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Multi-population models are used to model salmon life stages. For
each salmon population, three populations are modeled to represent the
immature, mature (recruitment), and escapement life stage. Natural and
hatchery fish are also separately modeled, thus, there are 6 population
units are needed if there is a hatchery for a single population and 3
population units if there is no hatchery. The escapement population is
used to predict the production of the next cohort of juveniles. The
<code>MOM@SexPars$SSBfrom</code> feature is used to predict the juvenile
population abundance at age 1 from the spawning from the escapement
pouplation unit.</p></li>
<li><p>Fish progress through the populations, i.e., life stages, based
on maturity status. Movement of fish from the recruitment to the
escapement life stage occurs in the year after maturity. While the
cohorts will advance to the next age class, the life cycle ‘catches up’
such that the generation time remains true to the real dynamics. More
about this in the next section. The openMSE feature intended for
hermaphroditism is utilized here.</p></li>
<li><p>Total natural smolt production (immature natural origin fish) is
predicted by the spawning output of the natural and hatchery spawners
(two population units) by a function written in salmonMSE and passed to
openMSE as a MICE Rel (see <code>salmonMSE:::makeRel_smolt()</code> and
<code>salmonMSE:::smolt_func()</code>). This function also implements
the fitness dynamics the reduces productivity based on the ratio of
hatchery spawners and the ratio of natural broodtake.</p></li>
<li><p>This same function also implements the hatchery dynamics by
removing natural and hatchery broodtake from the respective escapement
and specifies the hatchery smolt releases as immature hatchery origin
fish.</p></li>
<li><p>This function also updates the number of hatchery spawners if
there are external strays (annual fixed number) or from strays leaving
the system.</p></li>
<li><p>Another custom function specifies the reduction in marine
survival due to fitness loss (see <code>salmonMSE:::makeRel_SAR()</code>
and <code>salmonMSE:::SAR_fitness()</code>).</p></li>
<li><p>A multi-fleet model specifies the harvest rates for the
pre-terminal and terminal fisheries. Retention is specified within
openMSE from the mark rate if mark-selective fishing is
utilized.</p></li>
</ol>
<p><img src="../reference/figures/model-life-cycle.png"><!-- --></p>
<p><em>Representation of the life cycle stages (blue) modeled in
openMSE.</em></p>
</div>
<div class="section level2">
<h2 id="salmon-considerations">Salmon considerations<a class="anchor" aria-label="anchor" href="#salmon-considerations"></a>
</h2>
<p>openMSE models fish populations through an age-structured array. As
such, it can accommodate mixed brood-year returns. There are some
additional complexities in the age structure that needs to be adjusted
in order to model salmon.</p>
<ol style="list-style-type: decimal">
<li><p>In openMSE, the life stage resulting from juvenile
density-dependent survival occurs in the time step when spawning occurs.
However, smolt production occurs in the year after spawning. Therefore,
we advance the age structure of the escapement one extra year in openMSE
in order to ensure smolt production occurs in the correct time step. In
the reporting, i.e., converting openMSE output back to salmon specific
output, the escapement, abundance of spawners, broodtake, and the egg
production are adjusted back to the appropriate biological
year.</p></li>
<li><p>In the absence of a hatchery, the escapement is the number of
spawners. In such a scenario, the spawning output and the smolt
production can be calculated entirely within openMSE. With a hatchery,
the escapement is subject to broodtake and removal of hatchery fish, and
entry of strays from the spawning grounds. openMSE sees none of the
hatchery dynamics. Instead, a MICE function created by salmonMSE will
read in the natural and hatchery escapement from openMSE, calculate the
broodtake, removal of hatchery fish from spawning grounds, calculate
fitness, adjust the stock-recruit parameters, apply fitness to the egg
and smolt production, and return the natural smolt production as a
“recruitment deviation” to openMSE. This is a multiplicative term that
adjusts the natural smolt production that would have been created if
there were no hatchery (note ‘recruitment’ is used to refer to the life
stage after density-dependent survival, as commonly used in a marine
fisheries context, and not the salmon return). This function will also
calculate the hatchery smolt releases as an absolute number for
openMSE.</p></li>
<li><p>The hermaphroditism feature in openMSE, used by salmonMSE to
assign maturity, occurs at the beginning of the time step. At the same
time, fishing mortality occurs over the course of the time step
simultaneously with natural mortality. However, salmon fisheries
typically operate seasonally. The pre-terminal fishery occurs early in
the year, followed by maturation and the subsequent terminal fishery
later in the year. In other words, fish that mature within a given year
are vulnerable to both pre-terminal and terminal fisheries. To solve the
order of operations problem, openMSE uses two seasonal time steps to
model a full calendar year. The pre-terminal fishery only operates in
the first half of the year (odd time steps), maturation happens at the
beginning of the second half of the year (even time steps), and the
terminal fishery operates in the second half of the year. Ocean
mortality occurs on the immature component during the second half of the
year. All escapement, broodtake, spawning, and smolt production
operations occur at the beginning of the following year (odd time steps,
see bullet 1). No current front-end requires knowledge of the seasonal
time steps, all output is reported on an annual basis.</p></li>
</ol>
<p><img src="../reference/figures/model-state-var.png"><!-- --></p>
<p><em>Summary of the state variables stored in either openMSE or
salmonMSE. The intermediary section consists of functions to calculate
state variables pertaining to hatchery and habitat management
levers.</em></p>
</div>
<div class="section level2">
<h2 id="age-structured-representation">Age-structured representation<a class="anchor" aria-label="anchor" href="#age-structured-representation"></a>
</h2>
<p>The following figure illustrates the age structure of a salmon that
matures at age 3. In the matrix, the abundance of age zero and age 1
represent the abundance of egg and smolts, respectively. At age 2, the
abundance may represent juvenile fish in the marine life stage (although
it may occur over the course of ages 1 and 2) that is vulnerable to the
pre-terminal fishery. With maturity at age 3, the abundance at the
beginning of the time step can be the return that is vulnerable to the
terminal fishery. Later in the year, the escapement and the number of
spawners is also calculated.</p>
<p><img src="../reference/figures/model-age-structure.png"><!-- --></p>
<p><em>Age-structured representation of a salmon life cycle where all
fish mature at age 3. The colors represent three generations of
fish.</em></p>
<p>Various constraints in openMSE prevent implementation of this figure
in the model. First, there aren’t enough state variables within a single
time step to calculate the escapement and implement the hatchery
broodtake between the return and the spawning. Second, the
density-dependent survival must occur within the same time step as the
spawning. As a result, we must advance the age class with an additional
placeholder age class after maturity into the following year that
spawning actually occurs. However, we can then calculate the necessary
hatchery and spawning dynamics, including egg production, in salmonMSE
and merely pass the smolt production back to openMSE. The result is that
the age structure ‘catches up’ with the generational life cycle, as
shown below.</p>
<p>Additionally, two seasonal time steps per calendar year are needed to
model maturation of a cohort in between the timing of the pre-terminal
and terminal fishery. As a result, for immature salmon, vulnerability to
the pre-terminal seasonal fishery occurs in the first half of the year
and ocean mortality occurs in the second half of the year. For salmon
that mature, vulnerability to the terminal seasonal fishery occurs in
the second half of the year. The component of the cohort that matures
does not experience ocean mortality during the last year of life
(semelparous life history).</p>
<p><img src="../reference/figures/model-age-structure-openMSE.png"><!-- --></p>
<p><em>Salmon age structure as implemented in openMSE. Missing state
variables are stored in a data frame in salmonMSE during the
simulation.</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quang Huynh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
