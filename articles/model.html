<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="salmonMSE">
<title>Implementation of salmon dynamics • salmonMSE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Implementation of salmon dynamics">
<meta property="og:description" content="salmonMSE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">salmonMSE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/example.html">Simple example</a>
    <a class="dropdown-item" href="../articles/model.html">Implementation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Blue-Matter/salmonMSE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Implementation of salmon dynamics</h1>
            
            <h4 data-toc-skip class="date">2024-03-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/salmonMSE/blob/HEAD/vignettes/model.Rmd" class="external-link"><code>vignettes/model.Rmd</code></a></small>
      <div class="d-none name"><code>model.Rmd</code></div>
    </div>

    
    
<p>This article documents the implementation of a salmon operating model
in openMSE and is intended for readers familiar with the internal
structure of the MSEtool package, e.g., developers and advanced
users.</p>
<div class="section level2">
<h2 id="multimse">multiMSE<a class="anchor" aria-label="anchor" href="#multimse"></a>
</h2>
<p>salmonMSE takes advantage of the functionality of the <a href="https://openmse.com/features-multimse/" class="external-link">multiMSE</a> function in
MSEtool. <code>multiMSE</code> is intended for multi-population,
multi-fleet modeling where the “population” unit can be envisioned to be
any combination of a sex-specific single species model, multi-species
model, or multi-stock model. Features include:</p>
<ol style="list-style-type: decimal">
<li><p>Two-sex models where the spawning output to predict recruitment
for a population is a linear combination of the spawning output of the
set of populations in the model</p></li>
<li><p>Hermaphroditism in the sex dynamics such that either females or
males switch sexes and mechanistically, the abundance moves from one
population to another at the beginning of the time step based on an
ogive</p></li>
<li><p>Inter-population and intra-population dynamics where the
biological parameter for one population is updated by the abundance or
biomass of a set through a custom written function (“MICE”
modeling)</p></li>
<li><p>Multi-fleet model that can be used to allocate catches among
populations and fleets</p></li>
</ol>
<p>Salmon dynamics can be represented mechanistically using the same
functionality:</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Multi-population models are used to model salmon life stages. For
each salmon conservation unit (CU), three populations are modeled to
represent the immature, mature (recruitment), and escapement life stage.
Natural and hatchery fish are also separately modeled, thus, there are 6
population units if there is hatchery for the CU and 3 population units
if there is no hatchery.</p></li>
<li><p>Fish progress through the populations, i.e., life stages, based
on maturity status. Movement of fish from the recruitment to the
escapement life stage occurs in the year after maturity. While the
cohorts will advance to the next age class, the life cycle ‘catches up’
such that the generation time remains true to the real dynamics. More
about this in the next section.</p></li>
<li><p>Total natural smolt production (immature natural fish) is
predicted by the spawning output of the natural and hatchery spawners
(two population units) by a function written in salmonMSE and passed to
openMSE. This function also implements the fitness dynamics the reduces
productivity based on the ratio of hatchery spawners and the ratio of
natural broodtake.</p></li>
<li><p>This same function also implements the hatchery dynamics by
removing natural and hatchery broodtake from the respective escapement
and specifies the hatchery smolt releases as immature hatchery
fish.</p></li>
<li><p>Another custom function specifies the reduction in marine
survival due to fitness loss</p></li>
<li><p>A multi-fleet model specifies the harvest rate of the immature
and mature component of the CU separately</p></li>
</ol>
<p><img src="../reference/figures/model-life-cycle.png"><!-- --></p>
<p><em>Representation of the life cycle stages (blue) modeled in
openMSE.</em></p>
</div>
<div class="section level2">
<h2 id="salmon-considerations">Salmon considerations<a class="anchor" aria-label="anchor" href="#salmon-considerations"></a>
</h2>
<p>openMSE models fish populations through an age-structured array.
There are some additional complexities in the age structure that needs
to be adjusted for salmon.</p>
<ol style="list-style-type: decimal">
<li><p>In openMSE, the life stage resulting from juvenile
density-dependent survival occurs in the time step when spawning occurs.
However, smolt production occurs in the year after spawning. Therefore,
we advance the age structure of the escapement one extra year in openMSE
in order to ensure smolt production occurs in the correct time step. In
the reporting array, the escapement, abundance of spawners, broodtake,
and the spawning output (fry production) are adjusted back to the
correct year.</p></li>
<li><p>Marine survival can take place over the course of several years
if the marine life stage is longer than one year. The marine survival
term is applied in the age and year prior to maturity (currently, all
fish must mature at the same age). The fitness loss in marine survival
is also applied to this age class. In the future, the marine survival
can be accounted for in each year of the marine life stage of the age
structured model. For example, if marine survival is one percent over
two years, then the survival can be ten percent during each of those two
years.</p></li>
<li><p>In the absence of a hatchery, the escapement is the number of
spawners. The spawning output and the smolt production can be calculated
entirely within openMSE. With a hatchery, the escapement is subject to
broodtake and removal of hatchery fish from the spawning grounds.
openMSE sees none of the hatchery dynamics. Instead, a MICE function
created by salmonMSE will read in the natural and hatchery escapement
from openMSE, calculate the broodtake, removal of hatchery fish from
spawning grounds, calculate fitness, adjust the stock-recruit
parameters, apply fitness to the fry and smolt production, and return
the natural smolt production as a “recruitment deviation” to openMSE.
This is a multiplicative term that adjusts the natural smolt production
that would have been created if there were no hatchery (note
‘recruitment’ is used to refer to the life stage after density-dependent
survival, as commonly used in a marine fisheries context, and not the
salmon return). This function will also calculate the smolt releases as
an absolute number for openMSE.</p></li>
</ol>
<p><img src="../reference/figures/model-state-var.png"><!-- --></p>
<p><em>Summary of the state variables stored in either openMSE or
salmonMSE. The intermediary section consists of functions to calculate
state variables pertaining to hatchery and habitat management
levers.</em></p>
</div>
<div class="section level2">
<h2 id="age-structured-representation">Age-structured representation<a class="anchor" aria-label="anchor" href="#age-structured-representation"></a>
</h2>
<p>The following figure illustrates the age structure of a salmon that
matures at age 3. In a matrix the abundance of age zero and age 1
represent the abundance of fry and smolts, respectively. At age 2, the
abundance may represent juvenile fish in the marine life stage (although
it may occur over the course of ages 1 and 2). With maturity at age 3,
the abundance at the beginning of the time step can be the return. Later
in the year, the escapement and the number of spawners is also
calculated.</p>
<p><img src="../reference/figures/model-age-structure.png"><!-- --></p>
<p><em>Age-structured representation of a salmon life cycle where all
fish mature at age 3. The colors represent three generations of
fish.</em></p>
<p>Two constraints in openMSE prevent implementation of this figure in
the model. First, there aren’t enough state variables within a single
time step to calculate the escapement and implement the hatchery
broodtake between the return and the spawning. Second, the
density-dependent survival must occur within the same time step as the
spawning. As a result, we must advance the age class with an additional
placeholder age class after maturity into the following year that
spawning actually occurs. However, we can then calculate the necessary
hatchery and spawning dynamics, including fry production, in salmonMSE
and merely pass the smolt production back to openMSE. The result is that
the age structure ‘catches up’ with the generational life cycle, as
shown below.</p>
<p><img src="../reference/figures/model-age-structure-openMSE.png"><!-- --></p>
<p><em>Salmon age-structure as implemented in openMSE.</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Quang Huynh.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
